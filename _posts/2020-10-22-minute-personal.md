---
title: "[DB Table] Minute Personal"
date: 2020-10-22 00:50:05 -0400
categories: sql, structure
---

Table Minute Personal

게임의 해당 분의 10명의 column 항목에 해당하는 정보를 담은 list

gameid/minute/kills/deaths/assists/level/gold/cs

items : 아이템 창은 7개이기 때문에, 7 sized list를 항목으로 하는 10 sized list.
아이템을 분 단위로 정리해놓은 데이터는 없었기에, 아이템 관련 이벤트를 통해 만들어야했다.

굉장히 많은 버그들이 생기는 작업이었으며, db 리셋을 두어번 하게 만든 장본인이기도 하다.

버그 유발 요소

1. 어떤 행위이든 상관 없이 아이템 창에서 해당 아이템이 사라지면 ITEM DESTROYED event로 처리.
포션, 와드, 초시계, 아이템 업그레이드, 서폿템 업그레이드 등

2. 룬 등으로 생성되는 아이템에 대한 event가 없음.
초시계, 비스킷, 신발, 미해분, 빅토르시작템, 서폿템, 파이크 수당 등

3. ms 단위로 비슷하게 아이템 이벤트가 일어나면 같은 시간 이벤트로 처리하는 경향이 있음.
item undo를 처리할 때 골치아프게 됨.
아이템 구매와 되돌리기가 같은 시간으로 처리되면, 구매를 되돌리는 것인지 그 이전의 행동을 되돌리는 것인지 이전의 이벤트까지 보고 판단해야함.

4. 아이템 구매를 되돌리기할 때 남겨야 하는 하위템들.
3과 중복할 때 특히 문제가 됨. 예를 들어 3롱소드를 가진 상태에서 톱날 2개 구매가 동시에 처리된 후, 되돌리기를 한 번 할 때.
롱소드는 한 개만 다시 생겨야하지만, 코드 처리에 따라 2개가 생길 수 있음.

5. 초시계
초시계 사용과 상위템 구매할 때 파괴되는 경우 구분, 초시계 여러 개 사는 트롤 등

6. 아이템 하위템 변경
10시즌에는 죽무 하위템이 콜필드->군단의방패 로 변경되어, 해당 버전인 10.6 이전의 버전의 경우 하위템 정리를 따로 해줘야 했다.


아이템 관련 작업들은 11시즌 들어가면서 아이템 개편으로 대대적으로 손봐야할 예정 ㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜㅜ
